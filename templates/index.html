<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpellStock AI | Predictive Inventory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/main.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body class="noise-overlay bg-[#0a0a0c] text-[#f8fafc] overflow-x-hidden min-h-screen">
    <div id="root">
        <!-- Login View -->
        <div id="login-view" class="min-h-screen flex items-center justify-center relative overflow-hidden">
            <div class="fixed inset-0 bg-indigo-600/8 blur-[120px] -z-10 rounded-full"></div>
            <div class="glass-panel p-10 w-full max-w-md space-y-6 relative z-10">
                <div class="text-center space-y-2">
                    <div class="h-14 w-14 glass-panel rounded-2xl mx-auto flex items-center justify-center mb-5">
                        <div class="w-5 h-5 bg-indigo-500/90 rounded-sm rotate-45"></div>
                    </div>
                    <h1 class="page-title text-2xl font-bold text-white">SpellStock</h1>
                    <p class="chart-label text-[10px] text-white/40 uppercase tracking-widest">Initialize Neural Link</p>
                </div>
                <div class="space-y-4">
                    <div class="space-y-1.5">
                        <label class="chart-label text-[10px] text-white/50 block">Node Identity</label>
                        <input type="text" value="admin_main" class="input-clean w-full px-4 py-3 rounded-xl text-sm">
                    </div>
                    <div class="space-y-1.5">
                        <label class="chart-label text-[10px] text-white/50 block">Access Key</label>
                        <input type="password" value="••••••••" class="input-clean w-full px-4 py-3 rounded-xl text-sm">
                    </div>
                    <button id="btn-login" class="btn-primary w-full py-3.5 rounded-xl font-semibold text-sm">
                        Enter System
                    </button>
                </div>
                <p class="chart-subtext text-center text-white/30">Authorized Personnel Only</p>
            </div>
        </div>

        <!-- Dashboard View (Hidden by default) -->
        <div id="dashboard-view" class="hidden min-h-screen flex">
            <!-- Sidebar -->
            <aside class="w-64 border-r border-white/5 bg-[#0a0a0c] flex flex-col h-screen sticky top-0 z-[60]">
                <div class="p-6 border-b border-white/5 flex items-center gap-3">
                    <div class="h-8 w-8 bg-indigo-500/90 rounded-lg flex items-center justify-center rotate-45">
                        <div class="w-2 h-2 bg-white rounded-full"></div>
                    </div>
                    <span class="page-title text-base font-bold text-white">SpellStock</span>
                </div>
                <nav class="flex-1 p-4 space-y-1 overflow-y-auto" id="sidebar-nav"></nav>
                <div class="p-4 border-t border-white/5 space-y-3">
                    <div class="flex items-center gap-3 px-2">
                        <div class="w-8 h-8 rounded-full bg-indigo-500/20 border border-indigo-500/30 flex items-center justify-center text-[10px] font-bold">JD</div>
                        <div>
                            <p class="text-[10px] font-bold uppercase tracking-widest text-white">Chef de Node</p>
                            <p class="text-[9px] mono text-white/30 uppercase">ID: 4402-B</p>
                        </div>
                    </div>
                    <button id="btn-logout" type="button" class="w-full py-2 text-[10px] mono uppercase text-white/30 hover:text-white transition-colors flex items-center justify-center gap-2">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
                        Terminate Link
                    </button>
                </div>
            </aside>

            <!-- Main Content -->
            <div class="flex-1 flex flex-col relative">
                <header class="px-8 py-5 border-b border-white/5 flex items-center justify-between sticky top-0 bg-[#0a0a0c]/90 backdrop-blur-xl z-50">
                    <div>
                        <h1 class="page-title text-lg font-bold text-white">Dashboard</h1>
                        <p class="chart-label text-[10px] text-white/40 mt-0.5">AI prediction · Stock & risk</p>
                    </div>
                    <div class="flex items-center gap-5">
                        <div class="flex flex-col items-end">
                            <span class="chart-label text-[9px] text-white/30">Server Load</span>
                            <span class="text-xs font-semibold text-emerald-400">0.02ms</span>
                        </div>
                        <div class="h-6 w-px bg-white/10"></div>
                        <div class="flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/5 border border-white/5">
                            <div class="w-1.5 h-1.5 rounded-full bg-emerald-400"></div>
                            <span class="chart-label text-[10px] text-white/70">Gemini Connected</span>
                        </div>
                    </div>
                </header>

                <main class="p-8 space-y-10 max-w-[1400px] flex-1">
                    <!-- Oracle Dashboard panel -->
                    <div id="oracle-panel" class="space-y-10">
                    <section class="grid grid-cols-1 xl:grid-cols-12 gap-6 items-start">
                        <div class="xl:col-span-8 space-y-4">
                            <h2 class="section-title text-sm text-white/60">Scenario Input Console</h2>
                            <div class="glass-panel p-6 relative overflow-hidden group">
                                <div class="absolute top-0 right-0 p-8 opacity-5">
                                    <svg class="w-32 h-32" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                                </div>
                                <textarea id="scenario-input" placeholder="Describe the upcoming demand shift..." class="w-full bg-transparent border-none text-lg font-medium placeholder:text-white/20 focus:ring-0 resize-none h-36 mb-4 leading-snug"></textarea>
                                <div class="flex items-center justify-between border-t border-white/5 pt-5">
                                    <div class="flex flex-wrap gap-2" id="quick-actions"></div>
                                    <button id="btn-ignite" type="button" class="btn-primary flex items-center gap-3 py-2 pl-2 pr-6 rounded-full text-sm font-semibold disabled:opacity-40 disabled:cursor-not-allowed">
                                        <div id="ignite-icon" class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-black">
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M14 5l7 7m0 0l-7 7m7-7H3"/></svg>
                                        </div>
                                        <span>Ignite Logic</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="xl:col-span-4 space-y-4 h-full">
                            <h2 class="section-title text-sm text-white/50">Node Parameters</h2>
                            <div id="params-panel" class="glass-panel p-6 min-h-[320px] flex flex-col justify-between kinetic-border">
                                <div class="flex flex-col items-center justify-center h-full text-center space-y-4">
                                    <div class="w-12 h-12 border border-white/10 rounded-full flex items-center justify-center animate-pulse">
                                        <div class="w-2 h-2 bg-indigo-500/40 rounded-full"></div>
                                    </div>
                                    <p class="text-[10px] mono uppercase text-white/20 tracking-[0.2em]">Awaiting Simulation Data</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section class="space-y-5">
                        <div class="flex items-end justify-between flex-wrap gap-4">
                            <div>
                                <h2 class="page-title text-2xl font-bold text-white">Strategic <span class="text-white/50">Outlook</span></h2>
                                <p id="inventory-count" class="chart-subtext text-sm text-white/40 mt-1">Predicted exhaustion across key nodes.</p>
                            </div>
                            <div id="dashboard-stats" class="hidden md:flex gap-6"></div>
                        </div>
                        <div id="inventory-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"></div>
                    </section>

                    <!-- Reorder Alerts & Expiry (collapsible) -->
                    <section class="grid grid-cols-1 lg:grid-cols-2 gap-5">
                        <div class="collapsible-section glass-panel rounded-2xl overflow-hidden" data-section="reorder-alerts">
                            <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                <h3 class="section-title text-sm text-white/70">Reorder Alerts</h3>
                                <svg class="collapse-icon w-5 h-5 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                            </div>
                            <div class="collapsible-body px-6 py-4" style="max-height: 400px;">
                                <p class="chart-subtext text-white/40 mb-3">Items below reorder point — place orders to avoid stockouts.</p>
                                <div id="reorder-alerts-list" class="space-y-2">
                                    <div class="flex items-center justify-between py-2 px-3 rounded-lg bg-amber-500/10 border border-amber-500/20">
                                        <span class="text-sm font-medium">Cherry Tomatoes</span>
                                        <span class="mono text-[10px] text-amber-400">5 kg · Reorder</span>
                                    </div>
                                    <div class="flex items-center justify-between py-2 px-3 rounded-lg bg-red-500/10 border border-red-500/20">
                                        <span class="text-sm font-medium">Heavy Cream</span>
                                        <span class="mono text-[10px] text-red-400">3 L · Critical</span>
                                    </div>
                                    <p class="chart-subtext text-white/30 text-xs mt-2">AI uses demand forecast to suggest reorder timing.</p>
                                </div>
                            </div>
                        </div>
                        <div class="collapsible-section glass-panel rounded-2xl overflow-hidden" data-section="expiry">
                            <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                <h3 class="section-title text-sm text-white/70">Expiring Soon</h3>
                                <svg class="collapse-icon w-5 h-5 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                            </div>
                            <div class="collapsible-body px-6 py-4" style="max-height: 400px;">
                                <p class="chart-subtext text-white/40 mb-3">Use or move inventory before expiry to reduce waste.</p>
                                <div id="expiry-list" class="space-y-2">
                                    <div class="flex items-center justify-between py-2 px-3 rounded-lg bg-orange-500/10 border border-orange-500/20">
                                        <span class="text-sm font-medium">Fresh Salmon</span>
                                        <span class="mono text-[10px] text-orange-400">2 days</span>
                                    </div>
                                    <div class="flex items-center justify-between py-2 px-3 rounded-lg bg-amber-500/10 border border-amber-500/20">
                                        <span class="text-sm font-medium">Sourdough Bread</span>
                                        <span class="mono text-[10px] text-amber-400">1 day</span>
                                    </div>
                                    <p class="chart-subtext text-white/30 text-xs mt-2">Prediction engine factors shelf life into risk.</p>
                                </div>
                            </div>
                        </div>
                    </section>
                    <div class="pb-16"></div>
                    </div>

                    <!-- Inventory Hub panel (hidden by default) -->
                    <div id="inventory-hub-panel" class="hidden space-y-6 pb-16">
                        <div class="flex items-center justify-between flex-wrap gap-4">
                            <h2 class="section-title text-sm text-white/60">Restaurant Inventory Overview</h2>
                            <div class="flex items-center gap-2">
                                <label for="hub-restaurant-select" class="chart-label text-[10px] text-white/50">Location</label>
                                <select id="hub-restaurant-select" class="input-clean px-4 py-2 rounded-xl text-sm min-w-[160px]">
                                    <option value="main">Main Kitchen</option>
                                    <option value="downtown">Downtown Branch</option>
                                    <option value="harbor">Harbor View</option>
                                </select>
                            </div>
                        </div>
                        <div class="glass-panel p-6">
                            <h3 class="chart-label text-xs font-semibold text-white/50 mb-1">Location-by-Location Comparison</h3>
                            <p class="chart-subtext text-[10px] text-white/40 mb-4">Score 0–10 across locations</p>
                            <div class="h-[280px] flex items-center justify-center">
                                <canvas id="chart-comparison-bar" width="600" height="280"></canvas>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">
                            <div class="glass-panel p-6">
                                <h3 class="chart-label text-xs font-semibold text-white/50 mb-4">Risk Distribution</h3>
                                <div class="h-[260px] flex items-center justify-center">
                                    <canvas id="chart-risk-pie" width="260" height="260"></canvas>
                                </div>
                            </div>
                            <div class="glass-panel p-6">
                                <h3 class="chart-label text-xs font-semibold text-white/50 mb-4">Stock by Ingredient</h3>
                                <div class="h-[260px] flex items-center justify-center">
                                    <canvas id="chart-stock-bar" width="400" height="260"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="glass-panel p-6">
                            <h3 class="chart-label text-xs font-semibold text-white/50 mb-4">Total Stock by Location</h3>
                            <div class="h-[240px] flex items-center justify-center">
                                <canvas id="chart-locations-bar" width="500" height="240"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Reports panel (hidden by default) -->
                    <div id="reports-panel" class="hidden space-y-6 pb-16">
                        <h2 class="section-title text-sm text-white/60">Reports</h2>
                        <div class="collapsible-section glass-panel rounded-2xl overflow-hidden">
                            <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                <h3 class="section-title text-sm text-white/70">Low Stock Report</h3>
                                <svg class="collapse-icon w-5 h-5 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                            </div>
                            <div class="collapsible-body px-6 py-5" style="max-height: 500px;">
                                <p class="chart-subtext text-white/40 mb-4">Items below par level by location.</p>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-sm">
                                        <thead><tr class="text-left text-white/50 border-b border-white/10"><th class="pb-2 pr-4">Item</th><th class="pb-2 pr-4">Location</th><th class="pb-2">Status</th></tr></thead>
                                        <tbody id="report-low-stock" class="text-white/80">
                                            <tr class="border-b border-white/5"><td class="py-2 pr-4">Heavy Cream</td><td class="py-2 pr-4">Main</td><td class="py-2 text-amber-400">Low</td></tr>
                                            <tr class="border-b border-white/5"><td class="py-2 pr-4">Cherry Tomatoes</td><td class="py-2 pr-4">Downtown</td><td class="py-2 text-red-400">Critical</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="collapsible-section glass-panel rounded-2xl overflow-hidden">
                            <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                <h3 class="section-title text-sm text-white/70">Usage Report</h3>
                                <svg class="collapse-icon w-5 h-5 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                            </div>
                            <div class="collapsible-body px-6 py-5" style="max-height: 500px;">
                                <p class="chart-subtext text-white/40 mb-4">Consumption vs predicted (AI).</p>
                                <div class="space-y-2 text-sm text-white/70">Placeholder: usage vs forecast table will appear here.</div>
                            </div>
                        </div>
                        <div class="collapsible-section glass-panel rounded-2xl overflow-hidden">
                            <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                <h3 class="section-title text-sm text-white/70">Variance Report</h3>
                                <svg class="collapse-icon w-5 h-5 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                            </div>
                            <div class="collapsible-body px-6 py-5" style="max-height: 500px;">
                                <p class="chart-subtext text-white/40 mb-4">Actual vs expected stock levels.</p>
                                <div class="space-y-2 text-sm text-white/70">Placeholder: variance report table will appear here.</div>
                            </div>
                        </div>
                    </div>

                    <!-- Forecasts panel (hidden by default) -->
                    <div id="forecasts-panel" class="hidden space-y-6 pb-16">
                        <h2 class="section-title text-sm text-white/60">Forecasts</h2>
                        <div class="collapsible-section glass-panel rounded-2xl overflow-hidden">
                            <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                <h3 class="section-title text-sm text-white/70">Demand Forecast</h3>
                                <svg class="collapse-icon w-5 h-5 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                            </div>
                            <div class="collapsible-body px-6 py-5" style="max-height: 500px;">
                                <p class="chart-subtext text-white/40 mb-4">AI-predicted demand for the next 7 days.</p>
                                <div class="space-y-2 text-sm text-white/70">Placeholder: demand forecast chart/table will appear here.</div>
                            </div>
                        </div>
                        <div class="collapsible-section glass-panel rounded-2xl overflow-hidden">
                            <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                <h3 class="section-title text-sm text-white/70">Stockout Risk</h3>
                                <svg class="collapse-icon w-5 h-5 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/></svg>
                            </div>
                            <div class="collapsible-body px-6 py-5" style="max-height: 500px;">
                                <p class="chart-subtext text-white/40 mb-4">Predicted risk of stockout by item and location.</p>
                                <div class="space-y-2 text-sm text-white/70">Placeholder: stockout risk matrix will appear here.</div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>

            <!-- Footer Global HUD -->
            <footer class="fixed bottom-0 left-64 right-0 bg-[#0a0a0c]/95 backdrop-blur-md border-t border-white/5 px-6 py-2 flex items-center justify-between z-50">
                <div class="flex items-center gap-2">
                    <span class="w-1.5 h-1.5 bg-emerald-400 rounded-full"></span>
                    <span class="chart-label text-[10px] text-white/40">Prediction Engine Live</span>
                </div>
                <div class="chart-subtext text-[10px] text-white/30 flex items-center gap-3">
                    <span id="footer-time"></span>
                    <span>SpellStock v2.5</span>
                </div>
            </footer>
        </div>
    </div>
    <script>
        (function () {
            var el = document.getElementById('footer-time');
            if (el) {
                function tick() { el.textContent = new Date().toLocaleTimeString(); }
                tick();
                setInterval(tick, 1000);
            }
        })();
    </script>
    <script src="{{ url_for('static', filename='Backend/main.js') }}"></script>
</body>
</html>
