<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpellStock | Smart Kitchen Inventory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700;800&family=Poppins:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='Styles/main.css') }}">
</head>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>


<body class="noise-overlay bg-[#111110] text-[#fef3c7] overflow-x-hidden min-h-screen">
    <div id="root">
        <!-- Login View -->
        <div id="login-view" class="min-h-screen flex items-center justify-center relative overflow-hidden">
            <div class="fixed inset-0 bg-amber-600/6 blur-[120px] -z-10 rounded-full"></div>
            <div class="glass-panel p-10 w-full max-w-md space-y-6 relative z-10">
                <div class="text-center space-y-2">
                    <div class="h-14 w-14 mx-auto flex items-center justify-center mb-5">
                        <svg class="w-12 h-12 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M15.362 5.214A8.252 8.252 0 0112 21 8.25 8.25 0 016.038 7.048 6.287 6.287 0 009 9.6a6.287 6.287 0 003-5.386 6.287 6.287 0 003.362 1z" />
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M12 18a3.75 3.75 0 00.495-7.467 5.99 5.99 0 00-1.925 3.546 5.974 5.974 0 01-2.133-1A3.75 3.75 0 0012 18z" />
                        </svg>
                    </div>
                    <h1 class="page-title text-2xl font-bold text-white">SpellStock</h1>
                    <p class="chart-label text-[10px] text-amber-500/50 uppercase tracking-widest">Kitchen Intelligence
                    </p>
                </div>
                <div class="space-y-4">
                    <div class="space-y-1.5">
                        <label class="chart-label text-[10px] text-white/50 block">Username</label>
                        <input type="text" value="admin_main" class="input-clean w-full px-4 py-3 rounded-xl text-sm">
                    </div>
                    <div class="space-y-1.5">
                        <label class="chart-label text-[10px] text-white/50 block">Password</label>
                        <input type="password" value="••••••••" class="input-clean w-full px-4 py-3 rounded-xl text-sm">
                    </div>
                    <button id="btn-login" class="btn-primary w-full py-3.5 rounded-xl font-semibold text-sm">
                        Sign In
                    </button>
                </div>
                <p class="chart-subtext text-center text-white/30">Staff Access Only</p>
            </div>
        </div>

        <!-- Dashboard View (Hidden by default) -->
        <div id="dashboard-view" class="hidden min-h-screen flex">
            <!-- Sidebar -->
            <aside class="w-64 border-r border-amber-900/20 bg-[#111110] flex flex-col h-screen sticky top-0 z-[60]">
                <div class="p-6 border-b border-amber-900/20 flex items-center gap-3">
                    <div class="h-8 w-8 flex items-center justify-center">
                        <svg class="w-7 h-7 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            stroke-width="1.5">
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M15.362 5.214A8.252 8.252 0 0112 21 8.25 8.25 0 016.038 7.048 6.287 6.287 0 009 9.6a6.287 6.287 0 003-5.386 6.287 6.287 0 003.362 1z" />
                            <path stroke-linecap="round" stroke-linejoin="round"
                                d="M12 18a3.75 3.75 0 00.495-7.467 5.99 5.99 0 00-1.925 3.546 5.974 5.974 0 01-2.133-1A3.75 3.75 0 0012 18z" />
                        </svg>
                    </div>
                    <span class="page-title text-3xl font-bold text-white">SpellStock</span>
                </div>
                <nav class="flex-1 p-4 flex flex-col justify-evenly overflow-y-auto" id="sidebar-nav"></nav>
                <div class="p-4 border-t border-amber-900/20 space-y-3">
                    <div class="flex items-center gap-3 px-2">
                        <div
                            class="w-8 h-8 rounded-full bg-amber-500/20 border border-amber-500/30 flex items-center justify-center text-[10px] font-bold text-amber-400">
                            JD</div>
                        <div>
                            <p class="text-[10px] font-bold uppercase tracking-widest text-white">Head Chef</p>
                            <p class="text-[9px] mono text-white/30 uppercase">Main Kitchen</p>
                        </div>
                    </div>
                    <button id="btn-logout" type="button"
                        class="w-full py-2 text-[10px] mono uppercase text-white/30 hover:text-white transition-colors flex items-center justify-center gap-2">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                        Sign Out
                    </button>
                </div>
            </aside>

            <!-- Main Content -->
            <div class="flex-1 flex flex-col relative">
                <header
                    class="px-8 py-3 border-b border-amber-900/20 flex items-center justify-between sticky top-0 bg-[#111110]/90 backdrop-blur-xl z-50">
                    <div>
                        <h1 class="page-title title-poppins font-bold text-white" style="font-size:20px">Kitchen
                            Dashboard</h1>
                        <p class="chart-label text-[10px] text-amber-500/40 mt-0.5">AI-powered inventory & risk
                            management</p>
                    </div>
                    <div class="flex items-center gap-5">
                        <div class="flex flex-col items-end">
                            <span class="chart-label text-[9px] text-white/30">Response</span>
                            <span class="text-xs font-semibold text-emerald-400">0.02ms</span>
                        </div>
                        <div class="h-6 w-px bg-white/10"></div>
                        <div
                            class="flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-500/5 border border-amber-500/15">
                            <div class="w-1.5 h-1.5 rounded-full bg-emerald-400"></div>
                            <span class="chart-label text-[10px] text-white/70">AI Connected</span>
                        </div>
                    </div>
                </header>

                <main class="px-8 pt-4 pb-8 space-y-6 max-w-[1400px] flex-1">
                    <!-- Oracle Dashboard panel -->
                    <div id="oracle-panel" class="space-y-6">

                        <section class="space-y-5">
                            <!-- Dashboard Charts: Stock by Ingredient + Location Comparison -->
                            <!-- Row 1: Large graph + 2 stat cards -->
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-5">
                                <div class="lg:col-span-2 glass-panel p-6 relative"
                                    data-chart-id="dash-stock-ingredient">
                                    <button type="button" class="chart-info-btn" aria-label="Explain this chart">
                                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                        </svg>
                                    </button>
                                    <div class="chart-info-tooltip hidden"></div>
                                    <h3 class="chart-label text-xs font-semibold text-white/50 mb-1">Stock by Ingredient
                                    </h3>
                                    <p class="chart-subtext text-[10px] text-white/30 mb-4">Current stock levels vs par
                                        (live from Supabase)</p>
                                    <div class="h-[280px] flex items-center justify-center">
                                        <canvas id="dash-chart-stock-ingredient" width="500" height="280"></canvas>
                                    </div>
                                </div>
                                <div class="flex flex-col gap-4">
                                    <div class="forecast-card flex-1 flex flex-col justify-center">
                                        <div class="flex items-center gap-2 mb-2">
                                            <svg class="w-5 h-5 text-orange-400" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                            </svg>
                                            <span class="label">Active Alerts</span>
                                        </div>
                                        <span class="value text-3xl text-orange-400 font-bold"
                                            id="dash-stat-alerts">-</span>
                                        <span class="chart-subtext text-[10px] text-white/30 mt-1">High priority
                                            items</span>
                                    </div>
                                    <div class="forecast-card flex-1 flex flex-col justify-center">
                                        <div class="flex items-center gap-2 mb-2">
                                            <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                            </svg>
                                            <span class="label">Items Monitored</span>
                                        </div>
                                        <span class="value text-3xl text-blue-400 font-bold"
                                            id="dash-stat-items">-</span>
                                        <span class="chart-subtext text-[10px] text-white/30 mt-1">Total
                                            ingredients</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Row 2: 2 stat tiles + view more button | Large graph -->
                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-5">
                                <div class="flex flex-col gap-4">
                                    <div class="grid grid-rows-2 gap-3 flex-1">
                                        <div class="forecast-card flex items-center gap-4 px-5">
                                            <div class="flex-shrink-0">
                                                <svg class="w-8 h-8 text-amber-400" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                                </svg>
                                            </div>
                                            <div class="flex-1">
                                                <span class="label block text-[10px] mb-1">Risk Events</span>
                                                <span class="value text-2xl text-amber-400 font-bold"
                                                    id="dash-stat-risks">-</span>
                                            </div>
                                        </div>
                                        <div class="forecast-card flex items-center gap-4 px-5">
                                            <div class="flex-shrink-0">
                                                <svg class="w-8 h-8 text-red-400" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                                </svg>
                                            </div>
                                            <div class="flex-1">
                                                <span class="label block text-[10px] mb-1">Expiring Soon</span>
                                                <span class="value text-2xl text-red-400 font-bold"
                                                    id="dash-stat-expiring">-</span>
                                            </div>
                                        </div>
                                    </div>
                                    <button id="btn-view-inventory"
                                        class="btn-view-more px-6 py-3 rounded-xl border border-white/10 text-white/60 hover:text-white hover:border-amber-500/30 hover:bg-amber-500/5 transition-all text-sm font-semibold flex items-center justify-center gap-2 group">
                                        <span>View More</span>
                                        <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M9 5l7 7-7 7" />
                                        </svg>
                                    </button>
                                </div>
                                <div class="lg:col-span-2 glass-panel p-6 relative"
                                    data-chart-id="dash-location-compare">
                                    <button type="button" class="chart-info-btn" aria-label="Explain this chart">
                                        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                        </svg>
                                    </button>
                                    <div class="chart-info-tooltip hidden"></div>
                                    <h3 class="chart-label text-xs font-semibold text-white/50 mb-1">Location Comparison
                                    </h3>
                                    <p class="chart-subtext text-[10px] text-white/30 mb-4">Total stock & risk across
                                        locations</p>
                                    <div class="h-[280px] flex items-center justify-center">
                                        <canvas id="dash-chart-location-compare" width="500" height="280"></canvas>
                                    </div>
                                </div>
                            </div>

                            <div class="flex items-end justify-between flex-wrap gap-4">
                                <div>
                                    <h2 class="page-title title-poppins text-2xl font-bold text-white">Inventory <span
                                            class="text-amber-500/50">Outlook</span></h2>
                                    <p id="inventory-count" class="chart-subtext text-sm text-white/40 mt-1">Key items
                                        that need your attention.</p>
                                </div>
                                <div id="dashboard-stats" class="hidden md:flex gap-6"></div>
                            </div>

                            <!-- Dynamic alert-driven outlook cards -->
                            <div id="outlook-alerts" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4"></div>
                        </section>


                        <div class="pb-16"></div>
                    </div>

                    <!-- Inventory Hub panel (hidden by default) -->
                    <div id="inventory-hub-panel" class="hidden space-y-6 pb-16">
                        <div class="flex items-center justify-between flex-wrap gap-4">
                            <h2 class="section-title text-sm text-white/60">Restaurant Inventory Overview</h2>
                            <div class="flex items-center gap-2">
                                <label for="hub-restaurant-select"
                                    class="chart-label text-[10px] text-white/50">Location</label>
                                <select id="hub-restaurant-select"
                                    class="input-clean px-4 py-2 rounded-xl text-sm min-w-[160px]">
                                    <option value="main">Main Kitchen</option>
                                    <option value="downtown">Downtown Branch</option>
                                    <option value="harbor">Harbor View</option>
                                </select>
                            </div>
                        </div>

                        <!-- Summary Statistics Cards -->
                        <div id="hub-summary-stats" class="grid grid-cols-2 sm:grid-cols-5 gap-3">
                            <div class="forecast-card"><span class="label block mb-0.5">Ingredients</span><span
                                    class="value text-amber-400" id="hub-stat-ingredients">-</span></div>
                            <div class="forecast-card"><span class="label block mb-0.5">Total Stock</span><span
                                    class="value text-emerald-400" id="hub-stat-stock">-</span></div>
                            <div class="forecast-card"><span class="label block mb-0.5">Period Usage</span><span
                                    class="value text-indigo-400" id="hub-stat-used">-</span></div>
                            <div class="forecast-card"><span class="label block mb-0.5">Period Waste</span><span
                                    class="value text-orange-400" id="hub-stat-waste">-</span></div>
                            <div class="forecast-card"><span class="label block mb-0.5">Waste Rate</span><span
                                    class="value text-red-400" id="hub-stat-wasterate">-</span></div>
                        </div>

                        <div class="glass-panel p-6 relative" data-chart-id="hub-location-comparison">
                            <button type="button" class="chart-info-btn" aria-label="Explain this chart">
                                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                </svg>
                            </button>
                            <div class="chart-info-tooltip hidden"></div>
                            <h3 class="chart-label text-xs font-semibold text-white/50 mb-1">Location-by-Location
                                Comparison</h3>
                            <p class="chart-subtext text-[10px] text-white/40 mb-4">Score 0–10 across locations</p>
                            <div class="h-[280px] flex items-center justify-center">
                                <canvas id="chart-comparison-bar" width="600" height="280"></canvas>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">
                            <div class="glass-panel p-6 relative" data-chart-id="hub-risk-distribution">
                                <button type="button" class="chart-info-btn" aria-label="Explain this chart">
                                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                    </svg>
                                </button>
                                <div class="chart-info-tooltip hidden"></div>
                                <h3 class="chart-label text-xs font-semibold text-white/50 mb-4">Risk Distribution</h3>
                                <div class="h-[260px] flex items-center justify-center">
                                    <canvas id="chart-risk-pie" width="260" height="260"></canvas>
                                </div>
                            </div>
                            <div class="glass-panel p-6 relative" data-chart-id="hub-stock-ingredient">
                                <button type="button" class="chart-info-btn" aria-label="Explain this chart">
                                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                    </svg>
                                </button>
                                <div class="chart-info-tooltip hidden"></div>
                                <h3 class="chart-label text-xs font-semibold text-white/50 mb-4">Stock by Ingredient
                                </h3>
                                <div class="h-[260px] flex items-center justify-center">
                                    <canvas id="chart-stock-bar" width="400" height="260"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="glass-panel p-6 relative" data-chart-id="hub-stock-by-location">
                            <button type="button" class="chart-info-btn" aria-label="Explain this chart">
                                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                </svg>
                            </button>
                            <div class="chart-info-tooltip hidden"></div>
                            <h3 class="chart-label text-xs font-semibold text-white/50 mb-4">Total Stock by Location
                            </h3>
                            <div class="h-[240px] flex items-center justify-center">
                                <canvas id="chart-locations-bar" width="500" height="240"></canvas>
                            </div>
                        </div>

                        <!-- Usage Trend Chart -->
                        <div class="glass-panel p-6 relative" data-chart-id="hub-usage-trends">
                            <button type="button" class="chart-info-btn" aria-label="Explain this chart">
                                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                </svg>
                            </button>
                            <div class="chart-info-tooltip hidden"></div>
                            <h3 class="chart-label text-xs font-semibold text-white/50 mb-1">Usage Trends</h3>
                            <p class="chart-subtext text-[10px] text-white/40 mb-4">Last 7 days vs prior 7 days change
                                per ingredient</p>
                            <div class="h-[280px] flex items-center justify-center">
                                <canvas id="chart-usage-trends" width="600" height="280"></canvas>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-5">
                            <!-- Waste Analysis Chart -->
                            <div class="glass-panel p-6 relative" data-chart-id="hub-waste-analysis">
                                <button type="button" class="chart-info-btn" aria-label="Explain this chart">
                                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                    </svg>
                                </button>
                                <div class="chart-info-tooltip hidden"></div>
                                <h3 class="chart-label text-xs font-semibold text-white/50 mb-1">Waste Analysis</h3>
                                <p class="chart-subtext text-[10px] text-white/40 mb-4">Waste rate (%) by ingredient</p>
                                <div class="h-[260px] flex items-center justify-center">
                                    <canvas id="chart-waste-analysis" width="400" height="260"></canvas>
                                </div>
                            </div>
                            <!-- Daily Timeline Chart -->
                            <div class="glass-panel p-6 relative" data-chart-id="hub-daily-timeline">
                                <button type="button" class="chart-info-btn" aria-label="Explain this chart">
                                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                    </svg>
                                </button>
                                <div class="chart-info-tooltip hidden"></div>
                                <h3 class="chart-label text-xs font-semibold text-white/50 mb-1">Daily Usage & Waste
                                    Timeline</h3>
                                <p class="chart-subtext text-[10px] text-white/40 mb-4">Aggregated daily totals (last 14
                                    days)</p>
                                <div class="h-[260px] flex items-center justify-center">
                                    <canvas id="chart-daily-timeline" width="400" height="260"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reports panel (hidden by default) -->
                    <div id="reports-panel" class="hidden pb-16">
                        <div class="panel-header-row">
                            <h2 class="report-section-title">Reports</h2>
                            <div class="flex items-center gap-2">
                                <label for="reports-location-select"
                                    class="chart-label text-[10px] text-white/50">Location</label>
                                <select id="reports-location-select"
                                    class="input-clean px-4 py-2 rounded-xl text-sm min-w-[160px]">
                                    <option value="all">All locations</option>
                                    <option value="main">Main Kitchen</option>
                                    <option value="downtown">Downtown Branch</option>
                                    <option value="harbor">Harbor View</option>
                                </select>
                            </div>
                        </div>
                        <div class="space-y-5">
                            <div class="collapsible-section glass-panel rounded-2xl overflow-hidden relative"
                                data-chart-id="rpt-low-stock">
                                <div class="chart-info-tooltip hidden"></div>
                                <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                    <h3
                                        class="chart-label text-xs font-semibold text-white/70 uppercase tracking-wider">
                                        Low Stock Report</h3>
                                    <div class="flex items-center gap-2">
                                        <button type="button" class="chart-info-btn chart-info-btn--inline"
                                            aria-label="Explain this data">
                                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                            </svg>
                                        </button>
                                        <svg class="collapse-icon w-5 h-5 text-white/50 shrink-0" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 9l-7 7-7-7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="collapsible-body px-6 py-5" style="max-height: 420px;">
                                    <p class="chart-subtext text-[10px] text-white/40 mb-4">Items below par level by
                                        location.</p>
                                    <div class="overflow-x-auto">
                                        <table class="report-table" id="report-low-stock-table">
                                            <thead>
                                                <tr>
                                                    <th>Item</th>
                                                    <th>Location</th>
                                                    <th class="num">Current</th>
                                                    <th class="num">Par</th>
                                                    <th>Status</th>
                                                </tr>
                                            </thead>
                                            <tbody id="report-low-stock">
                                                <!-- Will be populated dynamically -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="collapsible-section glass-panel rounded-2xl overflow-hidden relative"
                                data-chart-id="rpt-usage">
                                <div class="chart-info-tooltip hidden"></div>
                                <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                    <h3
                                        class="chart-label text-xs font-semibold text-white/70 uppercase tracking-wider">
                                        Usage Report</h3>
                                    <div class="flex items-center gap-2">
                                        <button type="button" class="chart-info-btn chart-info-btn--inline"
                                            aria-label="Explain this data">
                                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                            </svg>
                                        </button>
                                        <svg class="collapse-icon w-5 h-5 text-white/50 shrink-0" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 9l-7 7-7-7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="collapsible-body px-6 py-5" style="max-height: 420px;">
                                    <p class="chart-subtext text-[10px] text-white/40 mb-4">Consumption vs AI-predicted
                                        usage.</p>
                                    <div class="overflow-x-auto">
                                        <table class="report-table">
                                            <thead>
                                                <tr>
                                                    <th>Item</th>
                                                    <th>Location</th>
                                                    <th class="num">Used</th>
                                                    <th class="num">Predicted</th>
                                                    <th class="num">Variance</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Will be populated dynamically -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="collapsible-section glass-panel rounded-2xl overflow-hidden relative"
                                data-chart-id="rpt-variance">
                                <div class="chart-info-tooltip hidden"></div>
                                <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                    <h3
                                        class="chart-label text-xs font-semibold text-white/70 uppercase tracking-wider">
                                        Variance Report</h3>
                                    <div class="flex items-center gap-2">
                                        <button type="button" class="chart-info-btn chart-info-btn--inline"
                                            aria-label="Explain this data">
                                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                            </svg>
                                        </button>
                                        <svg class="collapse-icon w-5 h-5 text-white/50 shrink-0" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 9l-7 7-7-7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="collapsible-body px-6 py-5" style="max-height: 420px;">
                                    <p class="chart-subtext text-[10px] text-white/40 mb-4">Actual vs expected stock
                                        levels (cycle count).</p>
                                    <div class="overflow-x-auto">
                                        <table class="report-table">
                                            <thead>
                                                <tr>
                                                    <th>Item</th>
                                                    <th>Location</th>
                                                    <th class="num">Expected</th>
                                                    <th class="num">Actual</th>
                                                    <th class="num">Diff</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Will be populated dynamically -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Forecasts panel (hidden by default) -->
                    <div id="forecasts-panel" class="hidden pb-16">
                        <div class="panel-header-row">
                            <h2 class="forecast-section-title">Forecasts</h2>
                            <div class="flex items-center gap-2">
                                <label for="forecasts-location-select"
                                    class="chart-label text-[10px] text-white/50">Location</label>
                                <select id="forecasts-location-select"
                                    class="input-clean px-4 py-2 rounded-xl text-sm min-w-[160px]">
                                    <option value="all">All locations</option>
                                    <option value="main">Main Kitchen</option>
                                    <option value="downtown">Downtown Branch</option>
                                    <option value="harbor">Harbor View</option>
                                </select>
                            </div>
                        </div>
                        <div class="space-y-5">
                            <div class="collapsible-section glass-panel rounded-2xl overflow-hidden relative"
                                data-chart-id="fc-demand-forecast">
                                <div class="chart-info-tooltip hidden"></div>
                                <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                    <h3
                                        class="chart-label text-xs font-semibold text-white/70 uppercase tracking-wider">
                                        Demand Forecast</h3>
                                    <div class="flex items-center gap-2">
                                        <button type="button" class="chart-info-btn chart-info-btn--inline"
                                            aria-label="Explain this data">
                                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                            </svg>
                                        </button>
                                        <svg class="collapse-icon w-5 h-5 text-white/50 shrink-0" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 9l-7 7-7-7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="collapsible-body px-6 py-5" style="max-height: 420px;">
                                    <p class="chart-subtext text-[10px] text-white/40 mb-4">AI-predicted demand for the
                                        next 7 days.</p>
                                    <div class="overflow-x-auto">
                                        <table class="report-table">
                                            <thead>
                                                <tr>
                                                    <th>Item</th>
                                                    <th>Location</th>
                                                    <th>Day 1–3</th>
                                                    <th>Day 4–5</th>
                                                    <th>Day 6–7</th>
                                                </tr>
                                            </thead>
                                            <tbody id="demand-forecast-tbody">
                                                <tr>
                                                    <td colspan="5" class="text-center text-white/30 py-6">Loading
                                                        forecast data...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div id="demand-forecast-stats" class="grid grid-cols-2 sm:grid-cols-4 gap-3 mt-4">
                                        <div class="forecast-card"><span class="label block mb-0.5">Horizon</span><span
                                                class="value" id="fc-stat-horizon">—</span></div>
                                        <div class="forecast-card"><span class="label block mb-0.5">Updated</span><span
                                                class="value" id="fc-stat-updated">—</span></div>
                                        <div class="forecast-card"><span class="label block mb-0.5">Model</span><span
                                                class="value" id="fc-stat-model">—</span></div>
                                        <div class="forecast-card"><span
                                                class="label block mb-0.5">Confidence</span><span class="value"
                                                id="fc-stat-confidence">—</span></div>
                                    </div>
                                </div>
                            </div>
                            <div class="collapsible-section glass-panel rounded-2xl overflow-hidden relative"
                                data-chart-id="fc-stockout-risk">
                                <div class="chart-info-tooltip hidden"></div>
                                <div class="collapsible-header px-6 py-4 border-b border-white/5" data-collapse-toggle>
                                    <h3
                                        class="chart-label text-xs font-semibold text-white/70 uppercase tracking-wider">
                                        Stockout Risk</h3>
                                    <div class="flex items-center gap-2">
                                        <button type="button" class="chart-info-btn chart-info-btn--inline"
                                            aria-label="Explain this data">
                                            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor"
                                                viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                    d="M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z" />
                                            </svg>
                                        </button>
                                        <svg class="collapse-icon w-5 h-5 text-white/50 shrink-0" fill="none"
                                            stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 9l-7 7-7-7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="collapsible-body px-6 py-5" style="max-height: 420px;">
                                    <p class="chart-subtext text-[10px] text-white/40 mb-4">Predicted risk of stockout
                                        by item and location.</p>
                                    <div class="overflow-x-auto">
                                        <table class="report-table">
                                            <thead>
                                                <tr>
                                                    <th>Item</th>
                                                    <th>Location</th>
                                                    <th class="num">Risk %</th>
                                                    <th>Level</th>
                                                    <th>Suggested action</th>
                                                </tr>
                                            </thead>
                                            <tbody id="stockout-risk-tbody">
                                                <tr>
                                                    <td colspan="5" class="text-center text-white/30 py-6">Loading risk
                                                        data...</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                    <div id="stockout-risk-stats" class="grid grid-cols-2 sm:grid-cols-4 gap-3 mt-4">
                                        <div class="forecast-card"><span class="label block mb-0.5">Critical
                                                items</span><span class="value status-critical"
                                                id="sr-stat-critical">—</span></div>
                                        <div class="forecast-card"><span class="label block mb-0.5">High
                                                risk</span><span class="value status-low" id="sr-stat-high">—</span>
                                        </div>
                                        <div class="forecast-card"><span class="label block mb-0.5">Horizon</span><span
                                                class="value" id="sr-stat-horizon">—</span></div>
                                        <div class="forecast-card"><span class="label block mb-0.5">Last run</span><span
                                                class="value" id="sr-stat-lastrun">—</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <script src="../static/backend/alerts.js"></script>
                    

                    <!-- ═══ ALERTS PANEL ═══ -->
                    <div id="alerts-panel" class="hidden pb-16">
                        <!-- ═══ INITIAL STATE: Hero CTA ═══ -->
                        <div id="alerts-initial"
                            class="flex flex-col items-center justify-center min-h-[60vh] text-center space-y-8">
                            <div class="relative">
                                <div class="absolute inset-0 bg-amber-500/10 blur-[80px] rounded-full -z-10"></div>
                                <div
                                    class="w-24 h-24 border-2 border-amber-500/30 rounded-full flex items-center justify-center mb-6 mx-auto">
                                    <svg class="w-12 h-12 text-amber-400" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                                    </svg>
                                </div>
                                <h2 class="page-title text-3xl font-bold text-white mb-3">Inventory <span
                                        class="text-amber-500/50">Scanner</span></h2>
                                <p class="text-sm text-white/30 max-w-md mx-auto leading-relaxed mb-8">Run a full
                                    scan of your inventory predictions — check stock levels, expiring items, and
                                    get AI-generated alerts for what needs ordering.</p>
                                <button id="btn-run-check" type="button"
                                    class="btn-primary inline-flex items-center gap-3 py-3 pl-3 pr-8 rounded-full text-base font-semibold mx-auto">
                                    <div id="check-icon"
                                        class="w-12 h-12 bg-white rounded-full flex items-center justify-center text-black">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                                d="M13 10V3L4 14h7v7l9-11h-7z" />
                                        </svg>
                                    </div>
                                    <span>Run Inventory Check</span>
                                </button>
                                <p id="alerts-scan-status"
                                    class="text-[10px] mono uppercase text-amber-500/20 tracking-[0.2em] mt-6">Ready to
                                    scan
                                </p>
                            </div>
                        </div>
                        <style>
                            .mini-card {
                                background: rgba(255, 255, 255, 0.04);
                                border: 1px solid rgba(255, 255, 255, 0.08);
                                border-radius: 0.75rem;
                                padding: 0.35rem 0.4rem;
                                display: flex;
                                flex-direction: column;
                                align-items: center;
                                color: rgba(255, 255, 255, 0.6);
                            }

                            .mini-card b {
                                color: white;
                                font-size: 0.75rem;
                            }
                        </style>

                        <!-- ═══ RESULTS STATE (hidden until scan completes) ═══ -->
                        <!-- ═══ RESULTS STATE ═══ -->
                        <div id="alerts-results" class="hidden h-[calc(100vh-8rem)]">
  <div class="flex items-center justify-between mb-3">
    <div class="flex items-center gap-3">
      <h3 class="text-sm font-semibold text-white/80">Live Alerts</h3>
      <button id="btn-refresh-alerts" type="button"
        class="px-3 py-1.5 text-[10px] uppercase tracking-wider font-medium rounded-lg border border-white/10 bg-white/5 text-white/60 hover:text-white hover:bg-white/10 transition-colors flex items-center gap-2">
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
        </svg>
        Refresh
      </button>
    </div>

    <!-- Loader (shows while scanning) -->
    <div id="alerts-loading" class="flex items-center gap-2 text-white/50 text-xs" style="display:none;">
      <div class="w-4 h-4 rounded-full border-2 border-white/20 border-t-white/70 animate-spin"></div>
      <div id="alerts-loading-text" class="animate-pulse">Scanning…</div>
    </div>
  </div>

  <!-- Live stack + history (most recent on top) -->
  <div id="alerts-stack" class="space-y-3 overflow-y-auto h-full pr-1"></div>
</div>




                    <!-- ═══ AGENT COPILOT PANEL ═══ -->
                    <div id="agent-panel" class="hidden pb-16">
                        <div class="panel-header-row mb-6">
                            <div>
                                <h2 class="section-title text-sm text-white/60">Agent Copilot</h2>
                                <p class="chart-subtext text-[10px] text-white/30 mt-1">AI assistant that thinks,
                                    investigates, and takes action on your inventory</p>
                            </div>
                            <div class="flex items-center gap-3">
                                <div
                                    class="flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-500/5 border border-amber-500/15">
                                    <div class="w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse"></div>
                                    <span class="chart-label text-[10px] text-white/70">Agent Active</span>
                                </div>
                                <button id="btn-copilot-reset" type="button"
                                    class="text-[9px] mono uppercase tracking-widest py-2 px-4 border border-white/10 rounded-full text-white/40 hover:text-white hover:bg-white/5 transition-all">
                                    New Session
                                </button>
                            </div>
                        </div>

                        <!-- Agent Stats -->
                        <div id="copilot-stats" class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-6">
                            <div class="forecast-card"><span class="label block mb-0.5">Tool Calls</span><span
                                    class="value text-amber-400" id="copilot-stat-tools">0</span></div>
                            <div class="forecast-card"><span class="label block mb-0.5">Actions Created</span><span
                                    class="value text-emerald-400" id="copilot-stat-actions">0</span></div>
                            <div class="forecast-card"><span class="label block mb-0.5">Turns</span><span
                                    class="value text-orange-400" id="copilot-stat-turns">0</span></div>
                            <div class="forecast-card"><span class="label block mb-0.5">Active Alerts</span><span
                                    class="value text-red-400" id="copilot-stat-alerts">0</span></div>
                        </div>

                        <!-- Command Input -->
                        <div class="glass-panel p-4 mb-6 flex items-center gap-3">
                                <div class="flex-1">
                                    <input id="agent-command-input" type="text"
                                        placeholder="Operator command... e.g. 'Fix top 3 stockout alerts' or 'Draft PO for chicken'"
                                        class="input-clean w-full px-4 py-3 rounded-xl text-sm" />
                                </div>
                                <button id="btn-agent-command" type="button"
                                    class="btn-primary w-10 h-10 rounded-full flex items-center justify-center shrink-0">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                            d="M14 5l7 7m0 0l-7 7m7-7H3" />
                                    </svg>
                                </button>
                            </div>
                        <!-- Quick Prompts -->
                        <div class="flex flex-wrap gap-2 mb-4">
                            <button
                                class="copilot-quick-btn text-[9px] mono uppercase tracking-widest py-2 px-4 border border-white/10 rounded-full hover:bg-white hover:text-black hover:border-white transition-all"
                                data-prompt="Analyze all active alerts and take action on the most critical ones">
                                Fix Critical Alerts
                            </button>
                            <button
                                class="copilot-quick-btn text-[9px] mono uppercase tracking-widest py-2 px-4 border border-white/10 rounded-full hover:bg-white hover:text-black hover:border-white transition-all"
                                data-prompt="Check inventory levels across all items and draft purchase orders for anything running low">
                                Auto-Restock
                            </button>
                            <button
                                class="copilot-quick-btn text-[9px] mono uppercase tracking-widest py-2 px-4 border border-white/10 rounded-full hover:bg-white hover:text-black hover:border-white transition-all"
                                data-prompt="Analyze usage trends for all items and suggest par level adjustments where usage patterns have changed">
                                Optimize Par Levels
                            </button>
                            <button
                                class="copilot-quick-btn text-[9px] mono uppercase tracking-widest py-2 px-4 border border-white/10 rounded-full hover:bg-white hover:text-black hover:border-white transition-all"
                                data-prompt="Give me a full operational status report — what's at risk, what actions have been taken, and what needs attention next">
                                Status Briefing
                            </button>
                        </div>

                        <!-- Copilot Conversation Area -->
                        <div class="glass-panel rounded-2xl overflow-hidden mb-6">
                            <div class="px-6 py-4 border-b border-white/5 flex items-center">
                                <div class="w-2 h-2 rounded-full bg-amber-500 mr-3"></div>
                                <h3
                                    class="chart-label text-xs font-semibold text-white/70 uppercase tracking-wider leading-none m-0">
                                    Agent Conversation</h3>
                                <span class="ml-auto text-[9px] mono text-white/20" id="copilot-session-id"></span>
                            </div>
                            <div id="copilot-messages" class="px-6 py-4 space-y-4 overflow-y-auto"
                                style="max-height: 550px; min-height: 200px;">
                                <!-- Welcome message -->
                                <div class="flex gap-3">
                                    <div
                                        class="w-7 h-7 rounded-lg bg-amber-500/20 border border-amber-500/30 flex items-center justify-center shrink-0 mt-0.5">
                                        <svg class="w-3.5 h-3.5 text-amber-400" fill="none" stroke="currentColor"
                                            viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13 10V3L4 14h7v7l9-11h-7z" />
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <div
                                            class="text-[10px] mono text-amber-400/60 uppercase tracking-widest mb-1.5">
                                            SpellStock Assistant</div>
                                        <div class="text-[13px] text-white/70 leading-relaxed">
                                            I'm your kitchen inventory assistant. I can <strong
                                                class="text-white/90">analyze stock levels</strong>, <strong
                                                class="text-white/90">spot risks</strong>, and <strong
                                                class="text-white/90">draft purchase orders</strong> for you.
                                            <br><br>
                                            Try: <em class="text-white/50">"What ingredients are running low?"</em>
                                            or <em class="text-white/50">"Draft a PO for chicken breast"</em>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Input -->
                            <div class="px-6 py-4 border-t border-white/5 flex items-center gap-3">
                                <div class="flex-1">
                                    <input id="copilot-input" type="text"
                                        placeholder="Ask about stock levels, order ingredients, check what's expiring..."
                                        class="input-clean w-full px-4 py-3 rounded-xl text-sm" />
                                </div>
                                <button id="btn-copilot-send" type="button"
                                    class="btn-primary w-11 h-11 rounded-full flex items-center justify-center shrink-0">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                            d="M14 5l7 7m0 0l-7 7m7-7H3" />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Actions Created by Agent -->
                        <div class="collapsible-section glass-panel rounded-2xl overflow-hidden mb-6">
                            <div class="collapsible-header px-6 py-4 border-b border-white/5 flex items-center"
                                data-collapse-toggle>
                                <h3
                                    class="chart-label text-xs font-semibold text-white/70 uppercase tracking-wider leading-none m-0">
                                    Action Queue</h3>
                                <div class="flex items-center gap-3 ml-auto">
                                    <select id="agent-filter-status"
                                        class="input-clean px-3 py-1.5 rounded-lg text-[10px] mono">
                                        <option value="">All Status</option>
                                        <option value="proposed">Proposed</option>
                                        <option value="approved">Approved</option>
                                        <option value="executed">Executed</option>
                                        <option value="rejected">Rejected</option>
                                        <option value="rolled_back">Rolled Back</option>
                                    </select>
                                    <select id="agent-filter-owner"
                                        class="input-clean px-3 py-1.5 rounded-lg text-[10px] mono">
                                        <option value="">All Owners</option>
                                        <option value="Purchasing">Purchasing</option>
                                        <option value="Kitchen">Kitchen</option>
                                        <option value="VendorOps">VendorOps</option>
                                    </select>
                                    <button id="btn-agent-auto" type="button"
                                        class="text-[9px] mono uppercase tracking-widest py-1.5 px-3 border border-emerald-500/30 text-emerald-400 rounded-full hover:bg-emerald-500/10 transition-all">Auto-Execute</button>
                                    <svg class="collapse-icon w-5 h-5 text-white/50 shrink-0" fill="none"
                                        stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M19 9l-7 7-7-7" />
                                    </svg>
                                </div>
                            </div>
                            <div class="collapsible-body px-6 py-4" style="max-height: 600px; overflow-y: auto;">
                                <div class="overflow-x-auto">
                                    <table class="report-table" id="agent-queue-table">
                                        <thead>
                                            <tr>
                                                <th class="cursor-pointer hover:text-white/80" data-sort="action_type">
                                                    Type ↕</th>
                                                <th>Ingredient</th>
                                                <th class="cursor-pointer hover:text-white/80" data-sort="risk_level">
                                                    Risk ↕</th>
                                                <th class="cursor-pointer hover:text-white/80" data-sort="owner_role">
                                                    Owner ↕</th>
                                                <th class="cursor-pointer hover:text-white/80" data-sort="status">
                                                    Status
                                                    ↕</th>
                                                <th>Reason</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="agent-queue-body">
                                            <tr>
                                                <td colspan="7" class="text-center text-white/20 py-8">No actions
                                                    yet.
                                                    Ask the agent to analyze and act.</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Diff View -->
                        <div id="agent-diff-view" class="hidden glass-panel rounded-2xl overflow-hidden mb-6">
                            <div class="px-6 py-4 border-b border-white/5 flex items-center justify-between">
                                <h3 class="chart-label text-xs font-semibold text-white/70 uppercase tracking-wider">
                                    Action Details</h3>
                                <button id="btn-close-diff" class="text-white/30 hover:text-white transition-colors">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                            <div id="agent-diff-content" class="px-6 py-4 space-y-4"></div>
                        </div>

                        <!-- Audit Log -->
                        <div class="collapsible-section glass-panel rounded-2xl overflow-hidden">
                            <div class="collapsible-header px-6 py-4 border-b border-white/5 flex items-center"
                                data-collapse-toggle>
                                <h3
                                    class="chart-label text-xs font-semibold text-white/70 uppercase tracking-wider leading-none m-0">
                                    Audit Log</h3>
                                <svg class="collapse-icon w-5 h-5 text-white/50 shrink-0 ml-auto" fill="none"
                                    stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M19 9l-7 7-7-7" />
                                </svg>
                            </div>
                            <div class="collapsible-body px-6 py-4" style="max-height: 400px; overflow-y: auto;">
                                <div id="agent-audit-log" class="space-y-2">
                                    <p class="text-[10px] mono text-white/20 text-center py-4">No audit entries yet.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>


                </main>
            </div>

            <!-- Footer Global HUD -->
            <footer
                class="fixed bottom-0 left-64 right-0 bg-[#111110]/95 backdrop-blur-md border-t border-amber-900/20 px-6 py-2 flex items-center justify-between z-50">
                <div class="flex items-center gap-2">
                    <span class="w-1.5 h-1.5 bg-emerald-400 rounded-full"></span>
                    <span class="chart-label text-[10px] text-white/40">Kitchen Intelligence Active</span>
                </div>
                <div class="chart-subtext text-[10px] text-white/30 flex items-center gap-3">
                    <span id="footer-time"></span>
                    <span>SpellStock v2.5</span>
                </div>
            </footer>
        </div>
    </div>
    <script>
        (function () {
            var el = document.getElementById('footer-time');
            if (el) {
                function tick() { el.textContent = new Date().toLocaleTimeString(); }
                tick();
                setInterval(tick, 1000);
            }
        })();
    </script>
    <script src="{{ url_for('static', filename='backend/main.js') }}?v={{ range(100000, 999999) | random }}"></script>
</body>

</html>